FIND_PROGRAM(PERL_EXECUTABLE perl)
MESSAGE(STATUS "perl executable ${PERL_EXECUTABLE}")
IF(PERL_EXECUTABLE)
  FIND_PACKAGE(PerlLibs)  
  IF(PERL_INCLUDE_PATH)
    Message(STATUS "enable perl interface\n")
    INCLUDE_DIRECTORIES(${PERL_INCLUDE_PATH})
    
    SET(INTERFACE_SRC ${CMAKE_CURRENT_SOURCE_DIR}/easdif-perl5.i)
    
    SET_SOURCE_FILES_PROPERTIES(${INTERFACE_SRC} PROPERTIES CPLUSPLUS ON)
    
    
    SET(CMAKE_SWIG_FLAGS "-I${CMAKE_CURRENT_SOURCE_DIR}")
    SWIG_ADD_MODULE(eaSDIF perl  ${INTERFACE_SRC}  )
    SWIG_LINK_LIBRARIES(eaSDIF ${PERL_LIBRARIES} Easdif${DEBUGEXT})
    ADD_CUSTOM_TARGET(perlswig)
    ADD_DEPENDENCIES(perlswig ${SWIG_MODULE_eaSDIF_REAL_NAME})
    ADD_DEPENDENCIES(${SWIG_MODULE_eaSDIF_REAL_NAME} ${SWIG_COMMON_EASDIF_SRC})
    CONFIGURE_FILE(${CMAKE_CURRENT_SOURCE_DIR}/test.pl.in ${CMAKE_CURRENT_BINARY_DIR}/test.pl @ONLY)    
    IF(EXISTS ${PERL_EXECUTABLE})
      ADD_CUSTOM_TARGET(check
        COMMAND echo Testing perl swig interface
        COMMAND LD_LIBRARY_PATH=$(CMAKE_BINARY_DIR)/easdif ${PERL_EXECUTABLE} ${CMAKE_CURRENT_BINARY_DIR}/test.pl)
    ENDIF(EXISTS ${PERL_EXECUTABLE})
  ENDIF(PERL_INCLUDE_PATH)
ENDIF(PERL_EXECUTABLE)
