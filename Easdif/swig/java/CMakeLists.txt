FIND_PACKAGE(Java)
IF(JAVA_RUNTIME)
  IF(NOT JAVA_COMPILE)
    FIND_PROGRAM(JAVA_COMPILE gcj)
  ENDIF(NOT JAVA_COMPILE)
  SET(INTERFACE_SRC ${CMAKE_CURRENT_SOURCE_DIR}/easdif-java.i)
ENDIF(JAVA_RUNTIME)
SET_SOURCE_FILES_PROPERTIES(${INTERFACE_SRC} PROPERTIES CPLUSPLUS ON)

SET(CMAKE_SWIG_FLAGS "-I${CMAKE_CURRENT_SOURCE_DIR}")
SWIG_ADD_MODULE(eaSDIF java  ${INTERFACE_SRC}     )
SWIG_LINK_LIBRARIES(eaSDIF ${PYTHON_LIBRARIES} Easdif${DEBUGEXT})
ADD_DEPENDENCIES(${SWIG_MODULE_eaSDIF_REAL_NAME} ${SWIG_COMMON_EASDIF_SRC})
ADD_CUSTOM_TARGET(javaswig)
ADD_DEPENDENCIES(javaswig ${SWIG_MODULE_eaSDIF_REAL_NAME})
ADD_DEPENDENCIES(${SWIG_MODULE_eaSDIF_REAL_NAME} ${SWIG_COMMON_EASDIF_SRC})

IF( EXISTS ${JAVA_RUNTIME})
  IF( EXISTS ${JAVA_COMPILE})
    ADD_CUSTOM_TARGET(check
      COMMAND echo Testing java swig interface
      COMMAND ${JAVA_COMPILE} *.java
      COMMAND LD_LIBRARY_PATH=$(CMAKE_BINARY_DIR)/easdif ${JAVA_RUNTIME} ${CMAKE_CURRENT_BINARY_DIR}/main)
  ENDIF( EXISTS ${JAVA_RUNTIME})
ENDIF( EXISTS ${JAVA_COMPILE})

